Absolutely cursed code, please disregard
